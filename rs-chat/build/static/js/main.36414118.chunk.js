(window["webpackJsonprs-chat"]=window["webpackJsonprs-chat"]||[]).push([[0],{14:function(e,t,a){},15:function(e,t,a){},16:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),o=a(3),c=a.n(o),r=a(1),i=a(4),m=a(5),l=a(7),u=a(6),g=a(8),f=function(e){return s.a.createElement("div",{className:"bg-primary pt-4 pb-4 pl-4"},"Welcome to chat, ",e.name,". ")},d=(a(14),function(e){return s.a.createElement("div",{className:"message-wrap d-flex flex-row"},s.a.createElement("p",{className:"author"},s.a.createElement("strong",null,e.name)),s.a.createElement("p",{className:"message"},e.message))}),p=(a(15),function(e){if(e.list){var t=e.list.map(function(e){return s.a.createElement(d,{name:e.from,message:e.message,key:e.id})});return s.a.createElement("div",{className:"chat-wrap mt-4 mb-4"},t)}return s.a.createElement("div",{className:"chat-wrap"},"connecting")}),N=function(e){return s.a.createElement("form",{onSubmit:function(t){e.sendMessage(t.target.message.value),t.target.message.value="",t.preventDefault(),t.stopPropagation()}},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col"},s.a.createElement("input",{name:"message",type:"text",className:"form-control",placeholder:"Type message"})),s.a.createElement("div",{className:"col"},s.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Send"))))},E=function(e){return s.a.createElement("form",{className:"pt-4",onSubmit:function(t){e.getName(t.target.name.value),t.preventDefault(),t.stopPropagation()}},s.a.createElement("p",null,"Please type your name to start chatting."),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col"},s.a.createElement("input",{name:"name",type:"text",className:"form-control",placeholder:"Type name"})),s.a.createElement("div",{className:"col"},s.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Submit"))))},v=function(e){var t="User ".concat(e.from," send message: ").concat(e.message);if("Notification"in window)if("granted"===Notification.permission)new Notification(t);else"denied"!==Notification.permission&&Notification.requestPermission(function(e){if("granted"===e)new Notification(t)});else alert("This browser does not support desktop notification")},w=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).ws=new WebSocket("ws://st-chat.shas.tel"),a.getName=function(e){localStorage.clear(),localStorage.setItem("name",e),a.setState({name:e})},a.addMessage=function(e){a.setState(function(t){var a;return{messages:(a=Object(r.a)(t.messages)).concat.apply(a,Object(r.a)(e))}})},a.sendMessage=function(e){var t={from:a.state.name,message:e};if(1===a.ws.readyState)a.ws.send(JSON.stringify(t));else{var n,s=localStorage.getItem("messages");(n=s?JSON.parse(s):[]).push(t),localStorage.setItem("messages",JSON.stringify(n))}},a.state={name:localStorage.getItem("name")||null,messages:[]},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){var e=this;this.ws.onopen=function(){console.log("connected");var t=localStorage.getItem("messages");t&&(JSON.parse(t).forEach(function(t){return e.ws.send(JSON.stringify(t))}),localStorage.removeItem("messages"))},this.ws.onmessage=function(t){var a=JSON.parse(t.data);e.addMessage(a),document.webkitHidden&&a.forEach(function(e){return v(e)})},this.ws.onclose=function(){console.log("disconnected"),setTimeout(function(){window.location.reload(!0)},8e3)}}},{key:"render",value:function(){return null===this.state.name?s.a.createElement("div",{className:"container"},s.a.createElement(E,{getName:this.getName})):s.a.createElement("div",{className:"container"},s.a.createElement(f,{name:this.state.name}),s.a.createElement(p,{list:this.state.messages}),s.a.createElement(N,{sendMessage:this.sendMessage}))}}]),t}(n.Component);c.a.render(s.a.createElement(w,null),document.getElementById("root"))},9:function(e,t,a){e.exports=a(16)}},[[9,1,2]]]);